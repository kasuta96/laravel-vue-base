#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

red=`tput setaf 1`
green=`tput setaf 2`
yellow=`tput setaf 3`
blue=`tput setaf 4`
magenta=`tput setaf 5`
cyan=`tput setaf 6`
bold=`tput bold`
reset=`tput sgr0`

echo "ğŸ‘·ğŸ” Checking code convention\n"

# Check phpcs
./vendor/bin/phpcs -n --standard=phpcs.xml ||
(
  echo "${red}[Check phpcs failed]${reset} Your php code styling looks disgusting. ğŸ¤¢ğŸ¤®"
  echo "ğŸ‘·ğŸ”¨ We tried using phpcbf to fix it\n"
  ./vendor/bin/phpcbf
  false;
)
echo "${green}[âœ… Check phpcs OK]${reset}\n"

# checking phpmd
./vendor/bin/phpmd app,config,routes text phpmd.xml ||
(
  echo "${red}[Check phpmd failed]${reset} Your php code SUCKS. ğŸ¤¬ğŸ–•\n"
  false;
)
echo "${green}[âœ… Check phpmd OK]${reset}\n"

# Now we can commit
echo "${green}[All Check SUCCESS]${reset} You're doing great, Babe. ğŸ‘ğŸ‰
  ${cyan}â¤ï¸ I am committing this now â¤ï¸${reset}\n"
